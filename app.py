# ======================================================================================
# ISIDA: –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç —Ä–µ–∂–∏—Å—Å–µ—Ä–∞ (V10.0 - –§–∏–Ω–∞–ª—å–Ω—ã–π —Ä–µ–ª–∏–∑ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏)
# ======================================================================================

import streamlit as st
from groq import Groq
from mistralai.client import MistralClient
import os
import re
from dotenv import load_dotenv

load_dotenv()

IZI_METHODOLOGY_OPTIMIZED = """
**1. –ò–∑—É—á–µ–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –≤—Ä–µ–º–µ–Ω–∏:**
- –ò—Å—Å–ª–µ–¥—É–π —ç–ø–æ—Ö—É –Ω–∞–ø–∏—Å–∞–Ω–∏—è: –∫–∞–∫–æ–π –ø–µ—Ä–∏–æ–¥, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ, –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ —Å–æ–±—ã—Ç–∏—è, –ª–∏—á–Ω–æ—Å—Ç–∏ —É –≤–ª–∞—Å—Ç–∏, –ø–µ—Ä–µ–≤–æ—Ä–æ—Ç—ã, —Ä–µ–≤–æ–ª—é—Ü–∏–∏.
- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –±–∏–æ–≥—Ä–∞—Ñ–∏—é –∞–≤—Ç–æ—Ä–∞ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è. –ù–∞–π–¥–∏ –ø–∞—Ä–∞–ª–ª–µ–ª–∏ –º–µ–∂–¥—É –µ–≥–æ –∂–∏–∑–Ω—å—é –∏ —Ç–µ–∫—Å—Ç–æ–º, –∏—â–∏ –Ω–µ–æ—á–µ–≤–∏–¥–Ω—ã–µ –∏–ª–∏ —Å–ø–æ—Ä–Ω—ã–µ —Ñ–∞–∫—Ç—ã.

**2. –ê–Ω–∞–ª–∏–∑ —Å–∞–º–æ–≥–æ –ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è:**
- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –Ω–∞–∑–≤–∞–Ω–∏–µ (–µ—Å–ª–∏ —ç—Ç–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ).
- –û–ø—Ä–µ–¥–µ–ª–∏ –∫–ª—é—á–µ–≤—ã–µ —Å–æ–±—ã—Ç–∏—è (–Ω–µ –±–æ–ª–µ–µ 5):
    - **–ò—Å—Ö–æ–¥–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ:** –ö–∞—Ç–∞–ª–∏–∑–∞—Ç–æ—Ä, –ø—Ä–æ–∏–∑–æ—à–µ–¥—à–∏–π –î–û –Ω–∞—á–∞–ª–∞ –ø—å–µ—Å—ã, "–∑–∞ –∑–∞–Ω–∞–≤–µ—Å–æ–º". –ß—Ç–æ –∑–∞–ø—É—Å—Ç–∏–ª–æ –≤—Å—é –∏—Å—Ç–æ—Ä–∏—é?
    - **–°—é–∂–µ—Ç–æ–æ–±—Ä–∞–∑—É—é—â–µ–µ —Å–æ–±—ã—Ç–∏–µ:** –ö–ª—é—á–µ–≤–æ–π –ø–æ–≤–æ—Ä–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –º–µ–Ω—è–µ—Ç –≤—Å—ë –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π —Å—é–∂–µ—Ç.
    - **–¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ:** –°–º—ã—Å–ª–æ–≤–æ–π —ç–∫–≤–∞—Ç–æ—Ä –ø—å–µ—Å—ã, —Ç–æ—á–∫–∞ –Ω–µ–≤–æ–∑–≤—Ä–∞—Ç–∞.
    - **–ì–ª–∞–≤–Ω–æ–µ (–∫—É–ª—å–º–∏–Ω–∞—Ü–∏–æ–Ω–Ω–æ–µ) —Å–æ–±—ã—Ç–∏–µ:** –ú–æ–º–µ–Ω—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∫–æ–Ω—Ñ–ª–∏–∫—Ç–∞, –≥–¥–µ –∫—Ä–∏—Å—Ç–∞–ª—å–Ω–æ —è—Å–Ω–∞ –∏–¥–µ—è –∞–≤—Ç–æ—Ä–∞.
    - **–§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ:** –ú–∞–ª–µ–Ω—å–∫–∏–π —à—Ç—Ä–∏—Ö –≤ –∫–æ–Ω—Ü–µ, –∫–æ—Ç–æ—Ä—ã–π –∑–∞–∫–æ–ª—å—Ü–æ–≤—ã–≤–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –∏–ª–∏ –ø—Ä–∏–¥–∞–µ—Ç –µ–π –Ω–æ–≤—ã–π —Å–º—ã—Å–ª.
- **–í–ê–ñ–ù–û–ï –ü–†–ê–í–ò–õ–û:** –°–æ–±—ã—Ç–∏–µ –¥–æ–ª–∂–Ω–æ –≤–ª–∏—è—Ç—å –Ω–∞ –í–°–ï–• –ø–µ—Ä—Å–æ–Ω–∞–∂–µ–π, —Ö–æ—Ç—è –±—ã –∫–æ—Å–≤–µ–Ω–Ω–æ. –ò–Ω–∞—á–µ —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ñ–∞–∫—Ç.

**3. –¢–µ–º–∞ –∏ –ò–¥–µ—è:**
- **–¢–µ–º–∞:** –û —á—ë–º —ç—Ç–æ? (–¢–æ, —á—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–æ: –ª—é–±–æ–≤—å, —Å–µ–º—å—è, –≤–æ–π–Ω–∞).
- **–ò–¥–µ—è:** –ß—Ç–æ –∞–≤—Ç–æ—Ä –¥—É–º–∞–µ—Ç –ø–æ –ø–æ–≤–æ–¥—É —ç—Ç–æ–π —Ç–µ–º—ã? (–ì–ª—É–±–æ–∫–∞—è, —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–∞—è –º—ã—Å–ª—å).

**4. –ö–æ–Ω—Ñ–ª–∏–∫—Ç:**
- –°—Ñ–æ—Ä–º—É–ª–∏—Ä—É–π –∫–∞–∫ –ø—Ä–æ—Ç–∏–≤–æ—Å—Ç–æ—è–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π –û–î–ù–û–ô –ö–ê–¢–ï–ì–û–†–ò–ò (–ê1 –ø—Ä–æ—Ç–∏–≤ –ê2), –∞ –Ω–µ "—á–µ–ª–æ–≤–µ–∫ –ø—Ä–æ—Ç–∏–≤ –æ–±—â–µ—Å—Ç–≤–∞".
- –†–∞–∑–¥–µ–ª–∏ –Ω–∞ —Ç–∏–ø—ã: –í–Ω–µ—à–Ω–∏–π (–≤–ª–∏—è–µ—Ç –Ω–∞ –≤—Å–µ—Ö), –í–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π (–≤–Ω—É—Ç—Ä–∏ –≥–µ—Ä–æ—è), –û—Å–Ω–æ–≤–Ω–æ–π.

**5. –°–≤–µ—Ä—Ö–∑–∞–¥–∞—á–∞:**
- **–°–≤–µ—Ä—Ö–∑–∞–¥–∞—á–∞ –∞–≤—Ç–æ—Ä–∞:** –†–∞–¥–∏ —á–µ–≥–æ –≥–ª–æ–±–∞–ª—å–Ω–æ –∞–≤—Ç–æ—Ä —ç—Ç–æ –Ω–∞–ø–∏—Å–∞–ª? –ö–∞–∫–æ–µ –µ–≥–æ –≥–ª–∞–≤–Ω–æ–µ –ø–æ—Å–ª–∞–Ω–∏–µ?
- **–°–≤–µ—Ä—Ö–∑–∞–¥–∞—á–∞ —Ä–µ–∂–∏—Å—Å–µ—Ä–∞:** –ü—Ä–µ–¥–ª–æ–∂–∏ 2-3 —Å–º–µ–ª—ã—Ö, —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞, —Ä–∞–¥–∏ —á–µ–≥–æ —ç—Ç–æ —Å—Ç–∞–≤–∏—Ç—å –°–ï–ô–ß–ê–°.
"""

st.set_page_config(layout="wide", page_title="ISIDA: –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç —Ä–µ–∂–∏—Å—Å–µ—Ä–∞")
st.title("üé≠ ISIDA: –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç —Ä–µ–∂–∏—Å—Å–µ—Ä–∞")

GROQ_API_KEY = os.getenv('GROQ_API_KEY') or st.secrets.get('GROQ_API_KEY')
MISTRAL_API_KEY = os.getenv('MISTRAL_API_KEY') or st.secrets.get('MISTRAL_API_KEY')

try:
    if not GROQ_API_KEY or not MISTRAL_API_KEY:
        st.error("API –∫–ª—é—á–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –¥–æ–±–∞–≤—å—Ç–µ –∏—Ö –≤ .env —Ñ–∞–π–ª –∏–ª–∏ –≤ Secrets –Ω–∞ Streamlit Cloud.")
        st.stop()
    groq_client = Groq(api_key=GROQ_API_KEY)
    mistral_client = MistralClient(api_key=MISTRAL_API_KEY)
except Exception as e:
    st.error(f"–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ API –∫–ª–∏–µ–Ω—Ç–æ–≤: {e}")
    st.stop()

def clean_markdown_for_copy(markdown_text):
    """–û—á–∏—â–∞–µ—Ç markdown-—Ä–∞–∑–º–µ—Ç–∫—É –¥–ª—è —á–∏—Å—Ç–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤ .docx."""
    text = re.sub(r'#+\s', '', markdown_text)
    text = re.sub(r'\*\*(.*?)\*\*', r'\1', text)
    text = re.sub(r'_(.*?)_', r'\1', text)
    text = re.sub(r'\*(.*?)\*', r'\1', text)
    text = text.replace('---', '\n')
    text = re.sub(r'\|.*\|', '', text) 
    text = re.sub(r'-\|', '', text)
    text = re.sub(r'\n{3,}', '\n\n', text)
    return text.strip()


def custom_copy_button(text_to_copy, button_text):
    """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç HTML/JS –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω–æ–π –∫–Ω–æ–ø–∫–∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è."""
   
    element_id = "text-to-copy-" + str(hash(text_to_copy))
    
    
    button_html = f"""
    <div id="{element_id}" style="display: none;">{text_to_copy}</div>
    <button onclick="copyToClipboard_{element_id}()">
        {button_text}
    </button>
    <script>
    function copyToClipboard_{element_id}() {{
        const text = document.getElementById('{element_id}').innerText;
        navigator.clipboard.writeText(text).then(() => {{
            alert('–¢–µ–∫—Å—Ç —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
        }}, (err) => {{
            alert('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –≤—Ä—É—á–Ω—É—é.');
        }});
    }}
    </script>
    """
    st.markdown(button_html, unsafe_allow_html=True)

col1, col2, col3 = st.columns([0.5, 2, 0.5])

with col2:
    st.header("–ú–∞—Ç–µ—Ä–∏–∞–ª –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞")
    piece_title = st.text_input("**–ù–∞–∑–≤–∞–Ω–∏–µ –ø—å–µ—Å—ã:**")
    author = st.text_input("**–ê–≤—Ç–æ—Ä:**")

    st.subheader("–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)")
    director_wishes = st.text_area(
        "–ü–æ–∂–µ–ª–∞–Ω–∏—è –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:", 
        placeholder="–ü—Ä–∏–º–µ—Ä: '–ù–∞–π–¥–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ñ–µ–º–∏–Ω–∏—Å—Ç—Å–∫–æ–º –¥–≤–∏–∂–µ–Ω–∏–∏ –≤ —Ç—É —ç–ø–æ—Ö—É' –∏–ª–∏ '–°–¥–µ–ª–∞–π –∞–∫—Ü–µ–Ω—Ç –Ω–∞ —ç–∫–æ–Ω–æ–º–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏—á–∏–Ω–∞—Ö –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤'."
    )

    if st.button("üöÄ –°–æ–∑–¥–∞—Ç—å —ç–∫—Å–ø–ª–∏–∫–∞—Ü–∏—é"):
        if not all([piece_title, author]):
            st.warning("–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø—å–µ—Å—ã –∏ –∏–º—è –∞–≤—Ç–æ—Ä–∞.")
        else:
            final_text = ""
            try:
                
                with st.spinner("–≠—Ç–∞–ø 1/2: –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å (Groq) –∏—â–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç..."):
                    research_prompt = (
                        f"–ü—Ä–æ–≤–µ–¥–∏ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—å–µ—Å—ã '{piece_title}' –∞–≤—Ç–æ—Ä–∞ {author}. "
                        "–ò—Å–ø–æ–ª—å–∑—É–π —Å–≤–æ–∏ –ø–æ–∏—Å–∫–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏. –ù–∞–π–¥–∏ –∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä—É–π –≤ –≤–∏–¥–µ –∫—Ä–∞—Ç–∫–æ–≥–æ –æ—Ç—á–µ—Ç–∞: "
                        "1. –¢–æ—á–Ω—ã–π –≥–æ–¥ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –∏ –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —ç—Ç–æ–π —ç–ø–æ—Ö–∏. "
                        "2. –ö–ª—é—á–µ–≤—ã–µ, –Ω–µ–æ—á–µ–≤–∏–¥–Ω—ã–µ —Ñ–∞–∫—Ç—ã –∏–∑ –±–∏–æ–≥—Ä–∞—Ñ–∏–∏ –∞–≤—Ç–æ—Ä–∞, —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Å –Ω–∞–ø–∏—Å–∞–Ω–∏–µ–º –ø—å–µ—Å—ã.\n"
                        f"–û–°–û–ë–û–ï –í–ù–ò–ú–ê–ù–ò–ï —É–¥–µ–ª–∏ —Å–ª–µ–¥—É—é—â–µ–º—É –ø–æ–∂–µ–ª–∞–Ω–∏—é: '{director_wishes if director_wishes else '–ë–µ–∑ –æ—Å–æ–±—ã—Ö –ø–æ–∂–µ–ª–∞–Ω–∏–π'}'. "
                        "–ò—â–∏ —Ç–æ—á–Ω—ã–µ, –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ —Ñ–∞–∫—Ç—ã."
                    )
                    
                    research_completion = groq_client.chat.completions.create(
                        messages=[{"role": "user", "content": research_prompt}],
                        model="llama-3.1-8b-instant" 
                    )
                    research_result = research_completion.choices[0].message.content
                    st.info("‚úÖ –ö–æ–Ω—Ç–µ–∫—Å—Ç –Ω–∞–π–¥–µ–Ω!")
               
                with st.spinner("–≠—Ç–∞–ø 2/2: –ê–Ω–∞–ª–∏—Ç–∏–∫ (Mistral) –ø–∏—à–µ—Ç —ç–∫—Å–ø–ª–∏–∫–∞—Ü–∏—é..."):
                    analysis_prompt = (
                        f"–¢—ã ‚Äî –≤—ã—Å–æ–∫–æ–∫–ª–∞—Å—Å–Ω—ã–π –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Ç–µ–∞—Ç—Ä–∞–ª—å–Ω–æ–≥–æ —Ä–µ–∂–∏—Å—Å–µ—Ä–∞. –ù–∞–ø–∏—à–∏ –ø–æ–ª–Ω—É—é —Ä–µ–∂–∏—Å—Å–µ—Ä—Å–∫—É—é "
                        f"—ç–∫—Å–ø–ª–∏–∫–∞—Ü–∏—é –¥–ª—è –ø—å–µ—Å—ã '{piece_title}' –∞–≤—Ç–æ—Ä–∞ {author}.\n\n"
                        "–î–ª—è –ø—É–Ω–∫—Ç–∞ 1 ('–ò–∑—É—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏') –∏—Å–ø–æ–ª—å–∑—É–π –æ—Ç—á–µ—Ç –∏—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—è. "
                        "–î–ª—è –æ—Å—Ç–∞–ª—å–Ω–æ–≥–æ ‚Äî —Å–≤–æ–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –∑–Ω–∞–Ω–∏—è –æ —Ç–µ–∫—Å—Ç–µ –ø—å–µ—Å—ã.\n\n"
                        f"–ù–ï–£–ö–û–°–ù–ò–¢–ï–õ–¨–ù–û —Å–ª–µ–¥—É–π –º–µ—Ç–æ–¥–æ–ª–æ–≥–∏–∏ —Ä–µ–∂–∏—Å—Å–µ—Ä–∞ –ò–∑–∏:\n{IZI_METHODOLOGY_OPTIMIZED}\n\n"
                        f"–û–¢–ß–ï–¢ –ò–°–°–õ–ï–î–û–í–ê–¢–ï–õ–Ø:\n{research_result}\n\n"
                        "–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π —Ñ–∏–Ω–∞–ª—å–Ω—ã–π, –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π markdown-–¥–æ–∫—É–º–µ–Ω—Ç."
                    )
                    
                    messages = [{"role": "user", "content": analysis_prompt}]
                    
                    chat_response = mistral_client.chat(
                        model="mistral-large-latest",
                        messages=messages
                    )
                    final_text = chat_response.choices[0].message.content

                st.header("‚úÖ –ì–æ—Ç–æ–≤–∞—è —ç–∫—Å–ø–ª–∏–∫–∞—Ü–∏—è:")
                
                if final_text:
                    clean_text = clean_markdown_for_copy(final_text)                   
                    custom_copy_button(clean_text, "üìã –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å —Ç–µ–∫—Å—Ç")
                    
                    st.download_button(
                        label="üì• –°–∫–∞—á–∞—Ç—å –≤—Å—é —ç–∫—Å–ø–ª–∏–∫–∞—Ü–∏—é (.txt)",
                        data=clean_text,
                        file_name=f"–≠–∫—Å–ø–ª–∏–∫–∞—Ü–∏—è_{piece_title}.txt",
                        mime="text/plain"
                    )

                st.subheader("–ê–Ω–∞–ª–∏–∑ –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º:")
                sections = re.split(r'\n---\n', final_text) 
                for i, section in enumerate(sections):
                    if section.strip():                        
                        cleaned_section_text = clean_markdown_for_copy(section)
                        title_match = re.search(r'#+\s*(.*)', cleaned_section_text)                        
                        title_for_file = title_match.group(1).strip() if title_match and title_match.group(1).strip() else f"–†–∞–∑–¥–µ–ª_{i+1}"
                        
                        display_title_match = re.search(r'#+\s*(.*)', section)
                        display_title = display_title_match.group(1).strip() if display_title_match else "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ"

                        with st.expander(f"**{display_title}**", expanded=(display_title.startswith("–†–ï–ñ–ò–°–°–Å–†–°–ö–ê–Ø"))):                            
                            st.download_button(
                                label=f"üì• –°–∫–∞—á–∞—Ç—å —Ä–∞–∑–¥–µ–ª '{title_for_file}'",
                                data=cleaned_section_text,
                                file_name=f"{piece_title}_{title_for_file}.txt",
                                mime="text/plain",
                                key=f"download_button_{i}" 
                            )
                            st.markdown("---") 
                            st.markdown(section, unsafe_allow_html=True)
            
            except Exception as e:
                st.error(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –≤–æ –≤—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: {e}")

    st.markdown("<br><br><br>", unsafe_allow_html=True) 
    st.markdown("---")    
    st.markdown("""
        <div style='text-align: center; color: grey;'>
            Made with ‚òïÔ∏è and ‚ù§Ô∏è for Izi.<br>
            –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑—å—é –º–æ–∂–Ω–æ <a href="https://t.me/LaSiddhartha" target="_blank" style="color: #888; text-decoration: underline;">–≤ Telegram</a>.
        </div>
    """, unsafe_allow_html=True)